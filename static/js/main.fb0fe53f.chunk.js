(this["webpackJsonpreact-typescript-template"]=this["webpackJsonpreact-typescript-template"]||[]).push([[0],{158:function(e,t,a){e.exports=a(213)},163:function(e,t,a){},213:function(e,t,a){"use strict";a.r(t);var n,r=a(0),o=a.n(r),c=a(11),s=a.n(c),i=(a(163),a(12)),u=a(9),l=a.n(u),d=a(15),m=a(39),p=a.n(m),f=a(250),b=a(251),g=a(272),E=a(265),k=a(273),v=a(249),h=a(268),w=a(254),O=a(3),x=a(4),y=a(94);!function(e){e.ID="id",e.USERNAME="username",e.EMAIL="email",e.STATUS="status"}(n||(n={}));var j,C,T,S=[{label:"Id",value:n.ID},{label:"User",value:n.USERNAME},{label:"Email",value:n.EMAIL},{label:"Status",value:n.STATUS}];!function(e){e.ASC="asc",e.DESC="desc"}(j||(j={})),function(e){e.OK="ok",e.ERROR="error"}(C||(C={})),function(e){e[e.OPEN=0]="OPEN",e[e.CLOSED=10]="CLOSED"}(T||(T={}));var R=a(34),A=Object(R.b)({name:"loginKey",initialState:{isAuthenticated:!1,authKey:"",windowOpen:!1},reducers:{setKey:function(e,t){var a=t.payload;e.authKey=a,e.isAuthenticated=!0,localStorage.setItem("token",a)},resetKey:function(e){e.authKey="",e.isAuthenticated=!1,localStorage.setItem("token","")},restoreAuthentication:function(e){var t=localStorage.getItem("token");t&&(e.authKey=t,e.isAuthenticated=!0)},openLoginWindow:function(e){e.windowOpen=!0},closeLoginWindow:function(e){e.windowOpen=!1}}}),N=A.reducer,P=A.actions,L=P.setKey,D=P.resetKey,_=P.restoreAuthentication,B=P.openLoginWindow,I=P.closeLoginWindow,K={taskList:[],page:1,totalPages:1,sorting:n.ID,direction:j.ASC,shouldUpdate:!1},M=Object(R.b)({name:"taskList",initialState:K,reducers:{setTaskList:function(e,t){var a=t.payload;e.taskList=a},setSorting:function(e,t){var a=t.payload;e.sorting=a},setDirection:function(e,t){var a=t.payload;e.direction=a?j.ASC:j.DESC},setPage:function(e,t){var a=t.payload;e.totalPages<a?e.page=e.totalPages:e.page=a<1?1:a},updatePage:function(e,t){var a=t.payload,n=e.taskList.findIndex((function(e){return e.id===a.id}));if(n>=0){var r=e.taskList.map((function(e){return e}));e.taskList[n].text!==a.text&&(a.isTextChanged=!0),r[n]=a,e.taskList=r}},setTotalPages:function(e,t){var a=t.payload;e.totalPages=a}}}),U=M.reducer,W=M.actions,q=W.setTaskList,F=W.setSorting,H=W.setDirection,V=W.setPage,z=W.updatePage,G=W.setTotalPages,J=Object(R.b)({name:"taskEdit",initialState:{taskData:null,windowOpen:!1,createTask:!1},reducers:{editTask:function(e,t){var a=t.payload;e.taskData=a,e.windowOpen=!0},createTask:function(e){e.taskData=null,e.windowOpen=!0},writeTask:function(e){e.createTask=!0},closeTaskEditWindow:function(e){e.windowOpen=!1},reset:function(e){e.taskData=null,e.windowOpen=!1,e.createTask=!1}}}),Y=J.reducer,$=J.actions,Q=$.editTask,X=$.createTask,Z=($.writeTask,$.closeTaskEditWindow),ee=($.reset,p()((function(){return{root:{display:"flex",justifyContent:"space-between"},label:{marginRight:5},whiteColor:{color:"#fff"},select:{width:80},button:{width:80},filterBlock:{display:"flex",justifyContent:"space-between",gridGap:50}}}))),te=Object(x.a)((function(){return{root:{color:"#fff",backgroundColor:y.a[500],"&:hover":{backgroundColor:y.a[700]}}}}))(v.a),ae=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.loginReducer})).authKey,a=Object(i.c)((function(e){return e.taskListReducer})),n=a.sorting,r=a.direction,c=ee();return o.a.createElement(f.a,{position:"static"},o.a.createElement(b.a,{className:c.root},o.a.createElement("div",{className:c.filterBlock},o.a.createElement("div",null,o.a.createElement(g.a,{htmlFor:"sorting-label",className:Object(O.a)(c.label,c.whiteColor)},"Sort by"),o.a.createElement(E.a,{labelId:"sorting-label",value:n,onChange:function(t){var a=t.target.value;e(F(a))},className:Object(O.a)(c.select,c.whiteColor)},S.map((function(e){return o.a.createElement(k.a,{value:e.value,key:e.value},e.label)})))),o.a.createElement(w.a,{control:o.a.createElement(h.a,{checked:r===j.ASC,onChange:function(t){e(H(t.target.checked))},name:"checkbox"}),label:"Asc/Desc"})),o.a.createElement(te,{onClick:function(){e(X())}},"Add task"),o.a.createElement(v.a,{className:Object(O.a)(c.whiteColor,c.button),onClick:function(){e(t?D():B())}},t?"LogOut":"LogIn")))},ne=a(256),re=a(258),oe=a(257),ce=a(276),se=a(89),ie=a.n(se),ue=a(138),le=a.n(ue),de=a(51),me=a(92),pe=a(93),fe=p()((function(){return{root:{marginTop:10},cardHeader:{height:65,boxSizing:"border-box"},avatar:{backgroundColor:me.a[500]},text:{whiteSpace:"pre-wrap",height:90,overflowY:"auto"}}})),be=function(e){var t=Object(i.b)(),a=e.data,n=a.id,r=a.username,c=a.email,s=a.text,u=a.status,l=a.isTextChanged,d=fe(),m=Object(i.c)((function(e){return e.loginReducer})).isAuthenticated;return o.a.createElement(ne.a,{onClick:function(){m&&t(Q({id:n,text:s,email:c,status:u,username:r}))},variant:"outlined",className:d.root},o.a.createElement(oe.a,{className:d.cardHeader,avatar:o.a.createElement(ce.a,{"aria-label":"user",className:d.avatar},r[0].toUpperCase()),action:o.a.createElement("div",null,u?o.a.createElement(ie.a,{style:{color:y.a[500]}}):null,l?o.a.createElement(le.a,{style:{color:pe.a[500]}}):null),title:r,subheader:c}),o.a.createElement(re.a,null,o.a.createElement(de.a,{variant:"body1",color:"textPrimary",gutterBottom:!0,component:"p",className:d.text},s)))},ge=p()((function(){return{root:{margin:10}}})),Ee=function(){var e=Object(i.c)((function(e){return e.taskListReducer})).taskList,t=ge(),a=Object(r.useMemo)((function(){return e.map((function(e){return o.a.createElement(be,{data:e,key:e.id})}))}),[e]);return o.a.createElement("div",{"aria-label":"task table",className:t.root},a)},ke=a(266),ve=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.taskListReducer})),a=t.page,n=t.totalPages;return n>1?o.a.createElement(ke.a,{count:n,page:a,size:"small",onChange:function(t,a){e(V(a))},showFirstButton:!0,showLastButton:!0}):null},he=Object(R.b)({name:"alert",initialState:{isError:!1,windowOpen:!1},reducers:{showAlert:function(e,t){var a=t.payload;a.message&&(e.message=a.message),e.isError=a.isError,e.windowOpen=!0},hideAlert:function(e){e.windowOpen=!1}}}),we=he.reducer,Oe=he.actions,xe=Oe.showAlert,ye=Oe.hideAlert,je=Object({NODE_ENV:"production",PUBLIC_URL:"/task_board",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_API_URL:"https://uxcandy.com/~shapoval/test-task-backend/v2",REACT_APP_DEVELOPER_NAME:"NAME"}),Ce=je.REACT_APP_DEVELOPER_NAME,Te=je.REACT_APP_API_URL,Se={errorMessage:"Something goes wrong"},Re=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,n,r,o,c,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.page,n=t.sorting,r="".concat(Te,"/?developer=").concat(Ce,"&page=").concat(a),r="".concat(r,"&sort_field=").concat(n.sortField,"&sort_direction=").concat(n.sortDirection),e.prev=3,e.next=6,fetch(r,{cache:"reload"});case 6:if(!(o=e.sent).ok){e.next=15;break}return e.next=10,o.json();case 10:if(c=e.sent,s=c.status,i=c.message,s!==C.OK){e.next=14;break}return e.abrupt("return",{data:{tasks:i.tasks,totalTaskCount:i.total_task_count}});case 14:return e.abrupt("return",{errorMessage:i||Se.errorMessage});case 15:return e.abrupt("return",Se);case 18:return e.prev=18,e.t0=e.catch(3),e.abrupt("return",Se);case 21:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,n,r,o,c,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.username,n=t.email,r=t.text,(o=new FormData).append("username",a),o.append("email",n),o.append("text",r),e.prev=5,e.next=8,fetch("".concat(Te,"/create/?developer=").concat(Ce),{method:"POST",body:o});case 8:if(!(c=e.sent).ok){e.next=15;break}return e.next=12,c.json();case 12:return s=e.sent,i=s.status,e.abrupt("return",i===C.OK);case 15:return e.abrupt("return",!1);case 18:return e.prev=18,e.t0=e.catch(5),e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(t){return e.apply(this,arguments)}}(),Ne=function(){var e=Object(d.a)(l.a.mark((function e(t,a){var n,r,o,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("username",t),n.append("password",a),e.prev=3,e.next=6,fetch("".concat(Te,"/login?developer=").concat(Ce),{method:"POST",body:n});case 6:if(!(r=e.sent).ok){e.next=15;break}return e.next=10,r.json();case 10:if(o=e.sent,c=o.status,s=o.message,c!==C.OK){e.next=14;break}return e.abrupt("return",{token:s.token});case 14:return e.abrupt("return",{errorMessage:s.password});case 15:return e.abrupt("return",Se);case 18:return e.prev=18,e.t0=e.catch(3),e.abrupt("return",Se);case 21:case"end":return e.stop()}}),e,null,[[3,18]])})));return function(t,a){return e.apply(this,arguments)}}(),Pe=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,n,r,o,c,s,i,u,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.id,n=t.text,r=t.taskStatus,o=t.token,(c=new FormData).append("token",o),c.append("text",n),c.append("status","".concat(r)),e.prev=5,e.next=8,fetch("".concat(Te,"/edit/").concat(a,"?developer=").concat(Ce),{method:"POST",body:c});case 8:if(!(s=e.sent).ok){e.next=18;break}return e.next=12,s.json();case 12:if(i=e.sent,u=i.status,d=i.message,u!==C.OK){e.next=16;break}return e.abrupt("return",{status:!0});case 16:if(!d.token){e.next=18;break}return e.abrupt("return",{status:!1,message:d.token});case 18:return e.abrupt("return",{status:!1});case 21:return e.prev=21,e.t0=e.catch(5),e.abrupt("return",{status:!1});case 24:case"end":return e.stop()}}),e,null,[[5,21]])})));return function(t){return e.apply(this,arguments)}}(),Le=a(64),De=a(90),_e=a(37),Be=a.n(_e),Ie=a(261),Ke=a(255),Me=a(91),Ue=a.n(Me),We=a(270),qe=a(271),Fe=a(262),He=a(263),Ve=a(259),ze=Object(Ve.a)((function(e){return{content:{display:"flex",flexDirection:"column",gridGap:15},dialog:{"& .MuiPaper-root":{backgroundColor:"#ccc"}},typography:{color:"#606079"},title:{margin:0,display:"flex",padding:e.spacing(2)},action:{justifyContent:"space-around",marginBottom:10,alignItems:"baseline"},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:"#000"},completeIcon:{padding:0},formContainer:{width:400,margin:"auto"}}})),Ge=a(260),Je=o.a.forwardRef((function(e,t){return o.a.createElement(Ge.a,Object.assign({direction:"up",ref:t},e))})),Ye=Be.a.object({username:Be.a.string().required(),password:Be.a.string().required()}),$e={username:"",password:""},Qe=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.loginReducer})).windowOpen,a=ze(),n=Object(Le.useForm)({defaultValues:$e,resolver:Object(De.joiResolver)(Ye)}),r=n.register,c=n.handleSubmit,s=n.errors,u=function(){e(I())},m=function(){var t=Object(d.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ne(a.username,a.password);case 2:"token"in(n=t.sent)?(e(L(n.token)),e(I()),e(xe({message:"Hello Admin",isError:!1}))):e(xe({message:n.errorMessage,isError:!0}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return o.a.createElement(We.a,{fullScreen:!0,onClose:u,open:t,className:a.dialog,TransitionComponent:Je},o.a.createElement("div",{className:a.formContainer},o.a.createElement(Ie.a,{disableTypography:!0,className:a.title},o.a.createElement(de.a,{variant:"h6",className:a.typography},"Login Form"),o.a.createElement(Ke.a,{"aria-label":"close",className:a.closeButton,onClick:u},o.a.createElement(Ue.a,null))),o.a.createElement("form",{onSubmit:c(m)},o.a.createElement(Fe.a,{className:a.content},o.a.createElement(qe.a,{name:"username",label:"Login",error:Boolean(s.username),helperText:Boolean(s.username)&&"\u0414\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e",inputRef:r({required:!0})}),o.a.createElement(qe.a,{name:"password",label:"Password",type:"password",error:Boolean(s.password),helperText:Boolean(s.password)&&"\u0414\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u043e",inputRef:r({required:!0})})),o.a.createElement(He.a,{className:a.action},o.a.createElement(v.a,{type:"submit",variant:"contained",color:"primary"},"authenticate")))))},Xe=a(267),Ze=a(264),et=a(274),tt=Object(Ve.a)((function(e){return{container:{position:"absolute",top:0,left:0,right:0,width:500,margin:"auto","& > * + *":{marginTop:e.spacing(2)}}}})),at=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.alertReducer})),a=t.isError,n=t.message,c=tt();return Object(r.useEffect)((function(){var t=setTimeout((function(){e(ye())}),2e3);return function(){return clearTimeout(t)}}),[]),o.a.createElement(et.a,{component:"div",className:c.container,zIndex:"tooltip"},a?o.a.createElement(Xe.a,{severity:"error"},o.a.createElement(Ze.a,null,"Error"),n):o.a.createElement(Xe.a,{severity:"success"},o.a.createElement(Ze.a,null,"Success"),n))},nt=a(112),rt=a(44),ot=Be.a.object({email:Be.a.string().email({tlds:{allow:!1}}).required(),username:Be.a.string().required(),text:Be.a.string().required()}),ct=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.taskEditReducer})),a=t.windowOpen,n=t.taskData,c=ze(),s={username:"",email:"",text:""};n&&(s={username:n.username,email:n.email,text:n.text});var u=Object(Le.useForm)({defaultValues:s,resolver:Object(De.joiResolver)(ot)}),m=u.register,p=u.handleSubmit,f=u.errors,b=function(){e(Z())},g=Object(r.useState)((null===n||void 0===n?void 0:n.status)||T.OPEN),E=Object(rt.a)(g,2),k=E[0],h=E[1],w=function(){var t=Object(d.a)(l.a.mark((function t(a){var r,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("token"),n){t.next=8;break}return t.next=4,Ae(a);case 4:t.sent||e(xe({isError:!0})),t.next=25;break;case 8:if(!r){t.next=17;break}return t.next=11,Pe({id:n.id,text:a.text,token:r,taskStatus:k});case 11:if((o=t.sent).status){t.next=15;break}return e(xe({message:o.message,isError:!0})),t.abrupt("return");case 15:t.next=22;break;case 17:return e(xe({message:"You have no rights!",isError:!0})),b(),e(D()),e(B()),t.abrupt("return");case 22:e(xe({message:"Well done!",isError:!1})),e(z(Object(nt.a)(Object(nt.a)({},n),{},{text:a.text,status:k}))),b();case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return o.a.createElement(We.a,{fullScreen:!0,onClose:b,open:a,className:c.dialog,TransitionComponent:Je},o.a.createElement("div",{className:c.formContainer},o.a.createElement(Ie.a,{disableTypography:!0,className:c.title},o.a.createElement(de.a,{variant:"h6",className:c.typography},n?"Edit Task":"Create Task"),k?o.a.createElement(ie.a,{style:{color:y.a[500]}}):null,o.a.createElement(Ke.a,{"aria-label":"close",className:c.closeButton,onClick:b},o.a.createElement(Ue.a,null))),o.a.createElement("form",{onSubmit:p(w)},o.a.createElement(Fe.a,{className:c.content},o.a.createElement(qe.a,{label:"User Name",variant:"outlined",name:"username",error:Boolean(f.username),helperText:Boolean(f.username)&&"Username should be set",InputProps:{readOnly:Boolean(n)},inputRef:m({required:!0})}),o.a.createElement(qe.a,{label:"Email",variant:"outlined",name:"email",error:Boolean(f.email),helperText:Boolean(f.email)&&"Email should be set in correct format",InputProps:{readOnly:Boolean(n)},inputRef:m({required:!0})}),o.a.createElement(qe.a,{label:"Task Text",variant:"outlined",multiline:!0,rows:4,name:"text",error:Boolean(f.text),helperText:Boolean(f.text)&&"Should write task",inputRef:m({required:!0})})),o.a.createElement(He.a,{className:c.action},n?o.a.createElement(v.a,{variant:"contained",color:"primary",onClick:function(){h(k?T.OPEN:T.CLOSED)}},"Change Status"):null,o.a.createElement(v.a,{variant:"contained",color:"primary",type:"submit"},n?"Update":"Create")))))},st=p()((function(){return{taskContainer:{margin:"auto",maxWidth:800}}})),it=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.taskListReducer})),a=t.page,n=t.sorting,c=t.direction,s=t.totalPages,u=Object(i.c)((function(e){return e.loginReducer})).windowOpen,m=Object(i.c)((function(e){return e.taskEditReducer})).windowOpen,p=Object(i.c)((function(e){return e.alertReducer})).windowOpen,f=st();return Object(r.useEffect)((function(){e(_())}),[]),Object(r.useEffect)((function(){(function(){var t=Object(d.a)(l.a.mark((function t(){var r,o,i,u,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Re({page:a,sorting:{sortField:n,sortDirection:c}});case 3:if(!("errorMessage"in(r=t.sent))){t.next=7;break}return e(xe({message:r.errorMessage,isError:!0})),t.abrupt("return");case 7:o=r.data,i=o.tasks,u=o.totalTaskCount,e(q(i)),d=Math.ceil(u/3),s!==d&&e(G(d)),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),e(xe({isError:!0}));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(){return t.apply(this,arguments)}})()()}),[a,n,c]),o.a.createElement("div",{className:"App"},o.a.createElement(ae,null),o.a.createElement("div",{className:f.taskContainer},o.a.createElement(Ee,null),o.a.createElement(ve,null)),u&&o.a.createElement(Qe,null),m&&o.a.createElement(ct,null),p&&o.a.createElement(at,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ut={loginReducer:N,taskEditReducer:Y,taskListReducer:U,alertReducer:we},lt=Object(R.a)({reducer:ut,devTools:!0});s.a.render(o.a.createElement(i.a,{store:lt},o.a.createElement(it,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[158,1,2]]]);
//# sourceMappingURL=main.fb0fe53f.chunk.js.map